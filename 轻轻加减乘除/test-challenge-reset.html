<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‘æˆ˜æ¨¡å¼é‡ç½®æµ‹è¯•</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/features.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        
        .test-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-steps {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .test-steps ol {
            margin-left: 20px;
        }
        
        .test-steps li {
            margin: 10px 0;
            line-height: 1.6;
        }
        
        .status-log {
            background: #1e1e1e;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .log-entry {
            margin: 5px 0;
            padding-left: 10px;
        }
        
        .log-success {
            color: #4caf50;
        }
        
        .log-error {
            color: #f44336;
        }
        
        .log-info {
            color: #2196f3;
        }
        
        .fix-details {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-info">
            <h1>ğŸ”§ æŒ‘æˆ˜æ¨¡å¼é‡ç½®é—®é¢˜ä¿®å¤æµ‹è¯•</h1>
            
            <div class="fix-details">
                <h3>âœ… ä¿®å¤å†…å®¹</h3>
                <p><strong>é—®é¢˜ï¼š</strong>ç‚¹å‡»æŒ‘æˆ˜æ¨¡å¼æ—¶æ˜¾ç¤ºä¹‹å‰çš„ç»“æœé¡µé¢ï¼Œè€Œä¸æ˜¯æ¨¡å¼é€‰æ‹©é¡µé¢</p>
                <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                <ul>
                    <li>åœ¨ <code>showChallengeMode()</code> ä¸­æ¢å¤é€‰æ‹©ç•Œé¢çš„HTML</li>
                    <li>åœ¨ <code>goHome()</code> ä¸­é‡ç½®æŒ‘æˆ˜é¡µé¢å†…å®¹</li>
                </ul>
            </div>
            
            <div class="test-steps">
                <h3>ğŸ“ æµ‹è¯•æ­¥éª¤</h3>
                <ol>
                    <li>ç‚¹å‡»ã€æŒ‘æˆ˜æ¨¡å¼ã€‘è¿›å…¥é€‰æ‹©é¡µé¢</li>
                    <li>é€‰æ‹©ä»»æ„ä¸€ç§æŒ‘æˆ˜æ¨¡å¼ï¼ˆå¦‚ä¸€åˆ†é’ŸæŒ‘æˆ˜ï¼‰</li>
                    <li>å®Œæˆæˆ–é€€å‡ºæŒ‘æˆ˜ï¼ŒæŸ¥çœ‹ç»“æœé¡µé¢</li>
                    <li>ç‚¹å‡»ã€è¿”å›é¦–é¡µã€‘</li>
                    <li>å†æ¬¡ç‚¹å‡»ã€æŒ‘æˆ˜æ¨¡å¼ã€‘</li>
                    <li>éªŒè¯æ˜¯å¦æ˜¾ç¤ºæ¨¡å¼é€‰æ‹©é¡µé¢ï¼ˆè€Œä¸æ˜¯ä¹‹å‰çš„ç»“æœï¼‰</li>
                </ol>
            </div>
        </div>
        
        <!-- ä¸»é¡µ -->
        <div id="homePage" class="page active">
            <div style="background: white; padding: 30px; border-radius: 10px; text-align: center;">
                <h2>ğŸ“š æ•°å­¦ç»ƒä¹  - ä¸»é¡µ</h2>
                <div style="margin: 30px 0;">
                    <button onclick="testShowChallengeMode()" style="padding: 15px 30px; font-size: 18px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 10px; cursor: pointer;">
                        âš¡ æŒ‘æˆ˜æ¨¡å¼
                    </button>
                </div>
            </div>
        </div>
        
        <!-- æŒ‘æˆ˜é¡µé¢ -->
        <div id="challengePage" class="page">
            <div class="page-header">
                <button class="back-btn" onclick="goHome()">â† è¿”å›</button>
                <h2>âš¡ æŒ‘æˆ˜æ¨¡å¼</h2>
            </div>
            <div class="challenge-content">
                <div class="challenge-modes">
                    <div class="challenge-card" onclick="startTimeChallenge(60)">
                        <div class="challenge-icon">â±ï¸</div>
                        <h3>ä¸€åˆ†é’ŸæŒ‘æˆ˜</h3>
                        <p>60ç§’å†…ç­”å¯¹å°½å¯èƒ½å¤šçš„é¢˜ç›®</p>
                        <div class="best-record">æœ€ä½³è®°å½•: <span id="best60">0</span> é¢˜</div>
                    </div>
                    <div class="challenge-card" onclick="startTimeChallenge(180)">
                        <div class="challenge-icon">â°</div>
                        <h3>ä¸‰åˆ†é’ŸæŒ‘æˆ˜</h3>
                        <p>180ç§’å†…ç­”å¯¹å°½å¯èƒ½å¤šçš„é¢˜ç›®</p>
                        <div class="best-record">æœ€ä½³è®°å½•: <span id="best180">0</span> é¢˜</div>
                    </div>
                    <div class="challenge-card" onclick="startSurvivalChallenge()">
                        <div class="challenge-icon">ğŸ’ª</div>
                        <h3>ç”Ÿå­˜æ¨¡å¼</h3>
                        <p>ç­”é”™å³ç»“æŸï¼Œçœ‹ä½ èƒ½åšæŒå¤šä¹…</p>
                        <div class="best-record">æœ€ä½³è®°å½•: <span id="bestSurvival">0</span> é¢˜</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- çŠ¶æ€æ—¥å¿— -->
        <div class="status-log" id="statusLog">
            <div class="log-entry log-info">ğŸ” æµ‹è¯•æ—¥å¿—</div>
            <div class="log-entry">ç­‰å¾…æ“ä½œ...</div>
        </div>
    </div>
    
    <!-- å¼•å…¥JSæ–‡ä»¶ -->
    <script src="js/app.js"></script>
    <script src="js/features.js"></script>
    
    <script>
        // åˆå§‹åŒ–
        const app = new MathPracticeApp();
        const featureManager = new FeatureManager();
        let stepCounter = 0;
        
        // æ—¥å¿—å‡½æ•°
        function addLog(message, type = '') {
            const log = document.getElementById('statusLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry ' + type;
            const time = new Date().toLocaleTimeString();
            entry.textContent = `[${time}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        // æµ‹è¯• showChallengeMode
        function testShowChallengeMode() {
            stepCounter++;
            addLog(`æ­¥éª¤ ${stepCounter}: ç‚¹å‡»æŒ‘æˆ˜æ¨¡å¼`, 'log-info');
            
            // æ£€æŸ¥é¡µé¢å†…å®¹
            const challengePage = document.getElementById('challengePage');
            const beforeContent = challengePage ? challengePage.innerHTML : '';
            
            // è°ƒç”¨åŸå§‹å‡½æ•°
            showChallengeMode();
            
            // æ£€æŸ¥ç»“æœ
            setTimeout(() => {
                const afterContent = challengePage ? challengePage.innerHTML : '';
                const hasSelectionUI = afterContent.includes('challenge-modes') && 
                                      afterContent.includes('ä¸€åˆ†é’ŸæŒ‘æˆ˜') &&
                                      afterContent.includes('ä¸‰åˆ†é’ŸæŒ‘æˆ˜');
                
                if (hasSelectionUI) {
                    addLog('âœ… æˆåŠŸæ˜¾ç¤ºæŒ‘æˆ˜æ¨¡å¼é€‰æ‹©ç•Œé¢', 'log-success');
                } else {
                    addLog('âŒ æœªæ­£ç¡®æ˜¾ç¤ºé€‰æ‹©ç•Œé¢', 'log-error');
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰æ®‹ç•™çš„ç»“æœå†…å®¹
                if (afterContent.includes('challenge-result')) {
                    addLog('âš ï¸ æ£€æµ‹åˆ°æ®‹ç•™çš„ç»“æœé¡µé¢å†…å®¹', 'log-error');
                }
            }, 100);
        }
        
        // æ¨¡æ‹ŸæŒ‘æˆ˜å®Œæˆ
        function simulateChallengeComplete() {
            stepCounter++;
            addLog(`æ­¥éª¤ ${stepCounter}: æ¨¡æ‹ŸæŒ‘æˆ˜å®Œæˆï¼Œæ˜¾ç¤ºç»“æœé¡µé¢`, 'log-info');
            
            const challengePage = document.getElementById('challengePage');
            if (challengePage) {
                challengePage.innerHTML = `
                    <div class="challenge-result">
                        <h2>ğŸ¯ æŒ‘æˆ˜ç»“æŸï¼ˆæµ‹è¯•ç»“æœé¡µï¼‰</h2>
                        <p>è¿™æ˜¯æ¨¡æ‹Ÿçš„ç»“æœé¡µé¢</p>
                        <div class="result-actions">
                            <button onclick="goHome()" class="btn-secondary">è¿”å›é¦–é¡µ</button>
                        </div>
                    </div>
                `;
                addLog('å·²åˆ‡æ¢åˆ°ç»“æœé¡µé¢', 'log-info');
            }
        }
        
        // é‡å†™ startTimeChallenge ç”¨äºæµ‹è¯•
        const originalStartTimeChallenge = window.startTimeChallenge;
        window.startTimeChallenge = function(seconds) {
            stepCounter++;
            addLog(`æ­¥éª¤ ${stepCounter}: å¼€å§‹${seconds}ç§’æŒ‘æˆ˜`, 'log-info');
            
            // æ¨¡æ‹ŸæŒ‘æˆ˜å¼€å§‹
            setTimeout(() => {
                simulateChallengeComplete();
            }, 2000);
            
            addLog('2ç§’åå°†è‡ªåŠ¨æ˜¾ç¤ºç»“æœé¡µé¢...', 'log-info');
        };
        
        // é‡å†™ goHome æ·»åŠ æ—¥å¿—
        const originalGoHome = window.goHome;
        window.goHome = function() {
            stepCounter++;
            addLog(`æ­¥éª¤ ${stepCounter}: è¿”å›é¦–é¡µ`, 'log-info');
            
            originalGoHome();
            
            // æ£€æŸ¥æŒ‘æˆ˜é¡µé¢æ˜¯å¦è¢«é‡ç½®
            setTimeout(() => {
                const challengePage = document.getElementById('challengePage');
                const content = challengePage ? challengePage.innerHTML : '';
                const hasSelectionUI = content.includes('challenge-modes');
                
                if (hasSelectionUI) {
                    addLog('âœ… æŒ‘æˆ˜é¡µé¢å·²é‡ç½®ä¸ºé€‰æ‹©ç•Œé¢', 'log-success');
                } else {
                    addLog('âš ï¸ æŒ‘æˆ˜é¡µé¢æœªæ­£ç¡®é‡ç½®', 'log-error');
                }
            }, 100);
        };
        
        // åˆå§‹åŒ–æ—¥å¿—
        addLog('æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ', 'log-success');
        addLog('ç‚¹å‡»ã€æŒ‘æˆ˜æ¨¡å¼ã€‘å¼€å§‹æµ‹è¯•', 'log-info');
    </script>
</body>
</html>
