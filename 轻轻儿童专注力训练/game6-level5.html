<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬5å…³ - è¿è¿çœ‹</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .match-grid {display:grid;grid-template-columns:repeat(5,1fr);gap:9px;max-width:400px;margin:15px auto;}
        .match-card {background:linear-gradient(135deg,#ffeaa7,#fdcb6e);border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:36px;cursor:pointer;border:4px solid transparent;aspect-ratio:1;transition:all .25s;}
        .match-card.selected {border-color:#00b894;transform:scale(1.08);box-shadow:0 0 15px #00b894aa;}
        .match-card.matched {background:linear-gradient(135deg,#55efc4,#00b894);animation:bounce .6s;opacity:.6;pointer-events:none;}
        .match-card.wrong {border-color:#e17055;animation:shake .5s;}
        .time-warning{color:#e17055;font-weight:bold;}
    </style>
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header"><div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info"><div class="level-title">è¿è¿çœ‹ â€¢ ç¬¬ 5 å…³ ğŸ‘‘</div><div class="timer" id="timer">â±ï¸ 120ç§’</div></div>
        </div>
        <div class="game-area">
            <div class="game-instruction">ğŸ† <strong>æŒ‘æˆ˜å…³å¡ï¼</strong><br>æ‰¾å‡º<strong>ä¸¤ä¸¤ç›¸åŒ</strong>çš„å°åŠ¨ç‰©é…å¯¹ï¼<br><small style="color:#e17055">âš ï¸ é™æ—¶120ç§’ï¼</small></div>
            <div style="text-align:center;margin:12px 0;font-size:18px;color:#666;">å·²é…å¯¹ <b id="pairsFound" style="color:#00b894;font-size:24px;">0</b> / <b id="totalPairs">0</b></div>
            <div class="match-grid" id="matchGrid"></div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2>ğŸ‰ æ­å–œé€šå…³!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p>ä½ æ˜¯è¿è¿çœ‹å¤§å¸ˆï¼ğŸ†</p>
            <p id="timeUsed">ç”¨æ—¶: 0ç§’</p>
            <p id="resultTips" style="margin-top:15px;padding:10px;background:#fff3cd;border-radius:8px;font-size:14px;line-height:1.6;color:#856404;"></p>
            <div>
                <button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-primary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button>
            </div>
        </div>
    </div>
    <div class="modal" id="failModal">
        <div class="modal-content">
            <h2>â° æ—¶é—´åˆ°!</h2>
            <p>æŒ‘æˆ˜å…³å¡å¾ˆéš¾ï¼Œä½†ä½ å·²ç»å¾ˆæ£’äº†ï¼</p>
            <div>
                <button class="btn btn-secondary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button>
                <button class="btn btn-primary" onclick="retryLevel()">ğŸ”„ é‡æ–°å¼€å§‹</button>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
    const ANIMALS=['ğŸ¶','ğŸ±','ğŸ°','ğŸ¦Š','ğŸ»','ğŸ¼','ğŸ¨','ğŸ¯','ğŸ¦','ğŸ·','ğŸ®','ğŸ¸'];
    let cards=[],selected=[],matched=0,totalPairs=0,timerInterval,startTime,errorCount=0,timeRemain=120,gameCompleted=false;
    function initGame(){
      startTime=Date.now();matched=0;selected=[];errorCount=0;timeRemain=120;gameCompleted=false;
      cards=[];
      ANIMALS.forEach(a=>{cards.push(a,a);});
      cards.sort(()=>Math.random()-.5);
      totalPairs=ANIMALS.length;
      document.getElementById('pairsFound').textContent=0;
      document.getElementById('totalPairs').textContent=totalPairs;
      renderCards();
      startTimer();
    }
    function renderCards(){
      let grid=document.getElementById('matchGrid');
      grid.innerHTML='';
      cards.forEach((animal,idx)=>{
        let div=document.createElement('div');
        div.className='match-card';
        div.textContent=animal;
        div.dataset.idx=idx;
        div.dataset.animal=animal;
        div.onclick=()=>selectCard(div,idx,animal);
        grid.appendChild(div);
      });
    }
    function selectCard(card,idx,animal){
      if(gameCompleted||card.classList.contains('matched')||card.classList.contains('selected')||selected.length>=2)return;
      playSound('click');
      card.classList.add('selected');
      selected.push({card,idx,animal});
      if(selected.length===2){
        setTimeout(()=>checkMatch(),500);
      }
    }
    function checkMatch(){
      let[a,b]=selected;
      if(a.animal===b.animal&&a.idx!==b.idx){
        playSound('correct');
        a.card.classList.remove('selected');
        b.card.classList.remove('selected');
        a.card.classList.add('matched');
        b.card.classList.add('matched');
        matched++;
        document.getElementById('pairsFound').textContent=matched;
        if(matched===totalPairs)setTimeout(()=>passGame(),400);
      }else{
        playSound('wrong');
        a.card.classList.add('wrong');
        b.card.classList.add('wrong');
        errorCount++;
        setTimeout(()=>{
          a.card.classList.remove('selected','wrong');
          b.card.classList.remove('selected','wrong');
        },700);
      }
      selected=[];
    }
    function startTimer(){
      const timerEl=document.getElementById('timer');
      timerEl.textContent='â±ï¸ 120ç§’';timerEl.classList.remove('time-warning');
      timerInterval=setInterval(()=>{
        timeRemain--;
        timerEl.textContent=`â±ï¸ ${timeRemain}ç§’`;
        if(timeRemain<=30)timerEl.classList.add('time-warning');
        if(timeRemain<=0){
          clearInterval(timerInterval);
          if(!gameCompleted){gameCompleted=true;showModal('failModal');}
        }
      },1000);
    }
    function passGame(){
      if(gameCompleted)return;gameCompleted=true;
      clearInterval(timerInterval);
      let used=120-timeRemain,stars=3;
      if(used>100||errorCount>=10)stars=1;else if(used>80||errorCount>=6)stars=2;
      updateLevelProgress('game6',5,stars);
      playSound('win');
      document.getElementById('starRating').textContent='â­'.repeat(stars)+'â˜†'.repeat(3-stars);
      document.getElementById('timeUsed').textContent=`ç”¨æ—¶: ${used}ç§’`;
      showModal('resultModal');
    }
    window.onload=initGame;
    </script>
</body>
</html>

