<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬2å…³ - è·¯å¾„è¿·å®«</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .maze-box{max-width:410px;margin:20px auto;background:#e0f7fa;border-radius:18px;box-shadow:0 1px 15px #81ecec44;padding:16px 10px;}
        .maze {display:grid;grid-template-columns:repeat(4,40px);gap:7px;justify-content:center;align-items:center;}
        .maze-cell {width:40px;height:40px;border-radius:9px;background:#fffefd;box-shadow:0 0 2px #bee1e1;justify-content:center;align-items:center;display:flex;font-size:34px;position:relative;transition:background .16s;}
        .maze-cell.wall {background:#ffe7e7;box-shadow:0 0 3px #ffaea2;}
        .maze-cell.goal {background:linear-gradient(135deg,#fffbe6 70%,#abe9cd 100%);}
        .maze-cell.player {background:linear-gradient(135deg,#d9fffc 80%,#ffe7ed 100%);border:2px solid #00b894;z-index:2;}
        .dir-btns {margin:18px auto 0;display:flex;flex-direction:column;align-items:center;gap:7px;}
        .dir-row{display:flex;gap:13px;}
        .dir-btn{width:40px;height:40px;background:#e0fafd;border:2px solid #3dc9b3;border-radius:11px;text-align:center;display:flex;align-items:center;justify-content:center;font-size:25px;cursor:pointer;transition:background .13s;}
        .dir-btn:active{background:#b2e1d7;}
        .maze-status{margin:5px 0 0;text-align:center;color:#24806d;}
    </style>
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header"><div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info"><div class="level-title">è·¯å¾„è¿·å®« â€¢ ç¬¬ 2 å…³</div><div class="timer" id="timer">â±ï¸ 0ç§’</div></div>
        </div>
        <div class="game-area">
            <div class="game-instruction">å¸®ğŸ°æƒ³åˆ°è¾¾èƒ¡èåœğŸ¥•ï¼Œç‚¹æ–¹å‘é”®æˆ–â†‘â†“â†â†’ç§»åŠ¨ï¼</div>
            <div class="maze-box"><div class="maze" id="maze"></div></div>
            <div class="dir-btns">
                <div class="dir-row"><button class="dir-btn" onclick="movePlayer(0,-1)">â¬†ï¸</button></div>
                <div class="dir-row"><button class="dir-btn" onclick="movePlayer(-1,0)">â¬…ï¸</button><div style="width:39px"></div><button class="dir-btn" onclick="movePlayer(1,0)">â¡ï¸</button></div>
                <div class="dir-row"><button class="dir-btn" onclick="movePlayer(0,1)">â¬‡ï¸</button></div>
            </div>
            <div class="maze-status" id="mazeStatus"></div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content"><h2>ğŸ‰ å¤ªæ£’äº†!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p>å°å…”å­åˆ°è¾¾èƒ¡èåœğŸ¥•ï¼</p>
            <p id="timeUsed">ç”¨æ—¶: 0ç§’</p>
            <div><button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button><button class="btn btn-primary" onclick="nextLevel('game8',2)">â¡ï¸ ä¸‹ä¸€å…³</button></div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
    // 1=è·¯ï¼Œ9=å¢™ï¼Œ2=ç»ˆç‚¹
    const MAZE=[
      [1,9,9,1],
      [1,1,9,1],
      [9,1,1,1],
      [2,9,9,1],
    ];
    const W=4,H=4,STARTX=3,STARTY=0; // å³ä¸Šè§’å‡ºå‘
    let player={x:STARTX,y:STARTY},moveCnt=0,errorCnt=0,timerInt,startTime;
    function renderMaze(){
      let mazeDom=document.getElementById('maze');mazeDom.innerHTML='';
      for(let y=0;y<H;y++)for(let x=0;x<W;x++){
        let cell=document.createElement('div');
        cell.className='maze-cell';
        if(MAZE[y][x]===9)cell.classList.add('wall');
        if(MAZE[y][x]===2)cell.classList.add('goal'),cell.innerHTML='ğŸ¥•';
        if(player.x===x&&player.y===y)cell.classList.add('player'),cell.innerHTML='ğŸ°';
        mazeDom.appendChild(cell);}}
    function movePlayer(dx,dy){
      let nx=player.x+dx,ny=player.y+dy;
      if(nx<0||ny<0||nx>=W||ny>=H)return shakeMsg('ä¸èƒ½å‡ºç•Œï¼');
      if(MAZE[ny][nx]===9)return shakeMsg('æ’åˆ°å¢™å•¦');
      playSound('click');
      player.x=nx;player.y=ny;moveCnt++;
      renderMaze();
      if(MAZE[ny][nx]===2)return setTimeout(passGame, 350);
    }
    function shakeMsg(msg){playSound('wrong');document.getElementById('mazeStatus').textContent=msg;let dom=document.querySelector('.maze-box');dom.style.animation='shake .5s';setTimeout(()=>{dom.style.animation=''},510);}
    function startTimer(){startTime=Date.now();moveCnt=0;errorCnt=0;if(timerInt)clearInterval(timerInt);timerInt=setInterval(()=>{let t=Math.floor((Date.now()-startTime)/1000);document.getElementById('timer').textContent=`â±ï¸ ${t}ç§’`;},1000);}
    function passGame(){clearInterval(timerInt);let used=Math.floor((Date.now()-startTime)/1000),stars=3;if(used>40||moveCnt>17)stars=1;else if(used>21||moveCnt>13)stars=2;updateLevelProgress('game8',2,stars);playSound('win');document.getElementById('starRating').textContent='â­'.repeat(stars)+'â˜†'.repeat(3-stars);document.getElementById('timeUsed').textContent=`ç”¨æ—¶: ${used}ç§’`;showModal('resultModal');}
    document.onkeydown=function(e){const map={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};if(map[e.key]){let[d1,d2]=map[e.key];movePlayer(d1,d2);}}
    window.onload=function(){player={x:STARTX,y:STARTY};renderMaze();startTimer();document.getElementById('mazeStatus').textContent='';}
    </script>
</body>
</html>
