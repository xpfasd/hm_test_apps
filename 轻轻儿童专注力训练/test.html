<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªåŠ¨åŒ–æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-item {
            padding: 10px;
            margin: 5px 0;
            border-left: 3px solid #ccc;
            background: #f9f9f9;
        }
        .test-item.pass {
            border-left-color: #4caf50;
            background: #e8f5e9;
        }
        .test-item.fail {
            border-left-color: #f44336;
            background: #ffebee;
        }
        .test-item.pending {
            border-left-color: #ff9800;
            background: #fff3e0;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #1976d2;
        }
        #console-output {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .log-entry {
            margin: 2px 0;
        }
        .log-error {
            color: #ef5350;
        }
        .log-warn {
            color: #ffb74d;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ä¸“æ³¨åŠ›è®­ç»ƒé¡¹ç›® - è‡ªåŠ¨åŒ–æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•æ§åˆ¶</h2>
        <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        <button onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
        <button onclick="openMainPage()">æ‰“å¼€ä¸»é¡µé¢</button>
        <button onclick="openGamePage()">æ‰“å¼€é¡¹ç›®é¡µé¢</button>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="test-results"></div>
    </div>

    <div class="test-section">
        <h2>æ§åˆ¶å°ç›‘æ§</h2>
        <div id="console-output"></div>
    </div>

    <script>
        let testResults = [];
        let consoleLogs = [];

        // æ•è·æ§åˆ¶å°è¾“å‡º
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;

        console.log = function(...args) {
            originalLog.apply(console, args);
            addConsoleLog('log', args.join(' '));
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            addConsoleLog('error', args.join(' '));
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addConsoleLog('warn', args.join(' '));
        };

        // æ•è·å…¨å±€é”™è¯¯
        window.addEventListener('error', function(e) {
            addConsoleLog('error', `JavaScripté”™è¯¯: ${e.message} at ${e.filename}:${e.lineno}`);
        });

        function addConsoleLog(type, message) {
            consoleLogs.push({ type, message, time: new Date().toLocaleTimeString() });
            updateConsoleDisplay();
        }

        function updateConsoleDisplay() {
            const output = document.getElementById('console-output');
            output.innerHTML = consoleLogs.slice(-50).map(log => 
                `<div class="log-entry log-${log.type}">[${log.time}] ${log.message}</div>`
            ).join('');
            output.scrollTop = output.scrollHeight;
        }

        function addTestResult(name, status, message = '') {
            testResults.push({ name, status, message });
            updateTestDisplay();
        }

        function updateTestDisplay() {
            const container = document.getElementById('test-results');
            container.innerHTML = testResults.map(test => 
                `<div class="test-item ${test.status}">
                    <strong>${test.name}</strong>: ${test.status === 'pass' ? 'âœ… é€šè¿‡' : test.status === 'fail' ? 'âŒ å¤±è´¥' : 'â³ å¾…æµ‹è¯•'}
                    ${test.message ? `<br><small>${test.message}</small>` : ''}
                </div>`
            ).join('');
        }

        function clearResults() {
            testResults = [];
            consoleLogs = [];
            updateTestDisplay();
            updateConsoleDisplay();
        }

        function openMainPage() {
            window.open('http://localhost:8000/index.html', '_blank');
        }

        function openGamePage() {
            window.open('http://localhost:8000/game1-level1.html', '_blank');
        }

        async function runAllTests() {
            clearResults();
            addTestResult('å¼€å§‹æµ‹è¯•', 'pending');
            
            // æµ‹è¯•1: æ£€æŸ¥ä¸»é¡µé¢æ˜¯å¦å¯è®¿é—®
            try {
                const response = await fetch('http://localhost:8000/index.html');
                if (response.ok) {
                    addTestResult('ä¸»é¡µé¢å¯è®¿é—®', 'pass');
                } else {
                    addTestResult('ä¸»é¡µé¢å¯è®¿é—®', 'fail', `HTTP ${response.status}`);
                }
            } catch (e) {
                addTestResult('ä¸»é¡µé¢å¯è®¿é—®', 'fail', e.message);
            }

            // æµ‹è¯•2: æ£€æŸ¥é¡¹ç›®é¡µé¢æ˜¯å¦å¯è®¿é—®
            try {
                const response = await fetch('http://localhost:8000/game1-level1.html');
                if (response.ok) {
                    addTestResult('é¡¹ç›®é¡µé¢å¯è®¿é—®', 'pass');
                } else {
                    addTestResult('é¡¹ç›®é¡µé¢å¯è®¿é—®', 'fail', `HTTP ${response.status}`);
                }
            } catch (e) {
                addTestResult('é¡¹ç›®é¡µé¢å¯è®¿é—®', 'fail', e.message);
            }

            // æµ‹è¯•3: æ£€æŸ¥CSSæ–‡ä»¶
            try {
                const response = await fetch('http://localhost:8000/css/style.css');
                if (response.ok) {
                    addTestResult('CSSæ–‡ä»¶å¯è®¿é—®', 'pass');
                } else {
                    addTestResult('CSSæ–‡ä»¶å¯è®¿é—®', 'fail', `HTTP ${response.status}`);
                }
            } catch (e) {
                addTestResult('CSSæ–‡ä»¶å¯è®¿é—®', 'fail', e.message);
            }

            // æµ‹è¯•4: æ£€æŸ¥JSæ–‡ä»¶
            try {
                const response = await fetch('http://localhost:8000/js/main.js');
                if (response.ok) {
                    addTestResult('JavaScriptæ–‡ä»¶å¯è®¿é—®', 'pass');
                } else {
                    addTestResult('JavaScriptæ–‡ä»¶å¯è®¿é—®', 'fail', `HTTP ${response.status}`);
                }
            } catch (e) {
                addTestResult('JavaScriptæ–‡ä»¶å¯è®¿é—®', 'fail', e.message);
            }

            // æµ‹è¯•5: æ£€æŸ¥localStorageæ”¯æŒ
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                if (value === 'value') {
                    addTestResult('localStorageæ”¯æŒ', 'pass');
                } else {
                    addTestResult('localStorageæ”¯æŒ', 'fail', 'å­˜å‚¨å€¼ä¸åŒ¹é…');
                }
            } catch (e) {
                addTestResult('localStorageæ”¯æŒ', 'fail', e.message);
            }

            // æµ‹è¯•6: æ£€æŸ¥å“åº”å¼æ–­ç‚¹
            const breakpoints = [
                { width: 360, name: 'å°å±æ‰‹æœº' },
                { width: 480, name: 'å¤§å±æ‰‹æœº' },
                { width: 768, name: 'å¹³æ¿' },
                { width: 1024, name: 'æ¡Œé¢' }
            ];

            breakpoints.forEach(bp => {
                const isMobile = bp.width <= 480;
                addTestResult(`å“åº”å¼æ–­ç‚¹: ${bp.name} (${bp.width}px)`, 'pending', 
                    `å»ºè®®: åœ¨æ­¤å®½åº¦ä¸‹æ‰‹åŠ¨æµ‹è¯•å¸ƒå±€`);
            });

            addTestResult('åŸºç¡€æµ‹è¯•å®Œæˆ', 'pass', 'è¯·æ‰‹åŠ¨æµ‹è¯•é¡µé¢åŠŸèƒ½å’Œå“åº”å¼è®¾è®¡');
        }

        // é¡µé¢åŠ è½½æ—¶è¿è¡Œåˆå§‹æ£€æŸ¥
        window.addEventListener('load', function() {
            console.log('æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('å½“å‰çª—å£å¤§å°:', window.innerWidth, 'x', window.innerHeight);
        });
    </script>
</body>
</html>

