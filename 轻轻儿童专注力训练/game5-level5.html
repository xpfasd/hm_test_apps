<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬5å…³ - å½¢çŠ¶æ‰¾ä¸€æ‰¾</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .shapes-grid {display:grid;grid-template-columns:repeat(5,1fr);gap:10px;max-width:400px;margin:15px auto 0;}
        .shape-card {background:#fff;border-radius:17px;display:flex;align-items:center;justify-content:center;font-size:37px;cursor:pointer;border:4px solid transparent;min-height:54px;transition:box-shadow .2s,border-color .2s,transform .13s;}
        .shape-card.correct {border-color:#00b894;box-shadow:0 0 10px #00b894aa;animation:bounce .6s;background:#edfff9;}
        .shape-card.wrong {border-color:#e17055;animation:shake .5s;background:#ffe7e5;}
        .shape-card.found {pointer-events:none;opacity:.45;}
        .shape-status-bar {margin:11px auto 8px;font-size:18px;color:#555;text-align:center;}
        .time-warning{color:#e17055;font-weight:bold;}
    </style>
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header"><div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info"><div class="level-title">å½¢çŠ¶æ‰¾ä¸€æ‰¾ â€¢ ç¬¬ 5 å…³ ğŸ‘‘</div><div class="timer" id="timer">â±ï¸ 60ç§’</div></div>
        </div>
        <div class="game-area">
            <div class="game-instruction">
                ğŸ† <strong>æŒ‘æˆ˜å…³å¡</strong>ï¼šæ‰¾å‡ºå…¨éƒ¨ <span style="color:#00b894;font-weight:bold">ç»¿è‰²ä¸‰è§’å½¢</span> <span style="font-size:28px;">ğŸ”º</span><br><small style="color:#e17055">é™æ—¶60ç§’ï¼Œå¹²æ‰°å½¢çŠ¶å¢å¤šï¼</small>
            </div>
            <div class="shape-status-bar">
                å·²æ‰¾åˆ° <b id="foundCount">0</b> / <b id="totalCount">0</b>
            </div>
            <div class="shapes-grid" id="shapesGrid"></div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2 id="resultTitle">ğŸ‰ æ­å–œé€šå…³!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p id="endText">ç»¿è‰²ä¸‰è§’å½¢å…¨æ‰¾é½ï¼</p>
            <p id="timeUsed">ç”¨æ—¶: 0ç§’</p>
            <p id="resultTips" style="margin-top:15px;padding:10px;background:#fff3cd;border-radius:8px;font-size:14px;line-height:1.6;color:#856404;"></p>
            <div>
                <button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-primary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button>
            </div>
        </div>
    </div>
    <div class="modal" id="failModal">
        <div class="modal-content">
            <h2>â° æ—¶é—´åˆ°!</h2>
            <p>æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å®Œæˆï¼Œå†è¯•ä¸€æ¬¡å§ï¼</p>
            <div>
                <button class="btn btn-secondary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button>
                <button class="btn btn-primary" onclick="retryLevel()">ğŸ”„ é‡æ–°å¼€å§‹</button>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
    // ç›®æ ‡ä¸ºâ€œç»¿è‰²ä¸‰è§’å½¢â€ï¼Œæ—¶é—´60ç§’ï¼Œæ··æ‚å„ç§ä¸‰è§’å’Œé¢œè‰²å¹²æ‰°
    const SHAPES = [
      {icon:'ğŸ”º', color:'#00b894', type:'green-triangle', isTarget:true },
      {icon:'ğŸ”º', color:'#00b894', type:'green-triangle', isTarget:true },
      {icon:'ğŸ”º', color:'#00b894', type:'green-triangle', isTarget:true },
      {icon:'ğŸ”º', color:'#fdcb6e', type:'orange-triangle', isTarget:false },
      {icon:'ğŸ”º', color:'#e17055', type:'red-triangle', isTarget:false },
      {icon:'ğŸ”º', color:'#0984e3', type:'blue-triangle', isTarget:false },
      {icon:'ğŸ”º', color:'#00b894', type:'green-triangle', isTarget:true },
      {icon:'ğŸŸ¦', color:'#0984e3', type:'blue-square', isTarget:false },
      {icon:'ğŸŸ ', color:'#fdcb6e', type:'orange-circle', isTarget:false },
      {icon:'ğŸ”¶', color:'#febd46', type:'orange-diamond', isTarget:false },
      {icon:'ğŸ”·', color:'#a29bfe', type:'purple-diamond', isTarget:false },
      {icon:'ğŸ”º', color:'#00b894', type:'green-triangle', isTarget:true },
      {icon:'â¬›', color:'#636e72', type:'black-square', isTarget:false },
      {icon:'ğŸ”¸', color:'#fd79a8', type:'pink-diamond', isTarget:false },
    ];
    let targets, found, canClick=true;
    let timerInterval, startTime, errorCount=0, timeRemain=60, gameCompleted=false;
    function renderShapes() {
      let grid = document.getElementById('shapesGrid');
      let shuffled = [...SHAPES].sort(()=>Math.random()-0.5);
      grid.innerHTML = '';
      found = 0;
      targets = shuffled.filter(s=>s.isTarget).length;
      document.getElementById('foundCount').textContent = 0;
      document.getElementById('totalCount').textContent = targets;
      shuffled.forEach((item,idx)=>{
        let div=document.createElement('div');
        div.className='shape-card';
        div.innerHTML=`<span style='color:${item.color};font-size:36px'>${item.icon}</span>`;
        div.title=item.type;
        div.onclick=()=>selectShape(div,item.isTarget);
        grid.appendChild(div);
      });
    }
    function selectShape(card,isTarget){
      if(!canClick||gameCompleted||card.classList.contains('found'))return;
      if(isTarget){//å¯¹
        playSound('correct');
        card.classList.add('correct','found');
        found++;
        document.getElementById('foundCount').textContent=found;
        if(found===targets) setTimeout(()=>passGame(), 350);
      }else{
        playSound('wrong');
        card.classList.add('wrong');errorCount++;
        setTimeout(()=>card.classList.remove('wrong'),600);
      }
    }
    function startTimer(){
      timeRemain=60;startTime=Date.now();gameCompleted=false;
      const timerEl=document.getElementById('timer');
      timerEl.textContent='â±ï¸ 60ç§’';timerEl.classList.remove('time-warning');
      timerInterval=setInterval(()=>{
        timeRemain--;
        timerEl.textContent=`â±ï¸ ${timeRemain}ç§’`;
        if(timeRemain<=15)timerEl.classList.add('time-warning');
        if(timeRemain<=0){
          clearInterval(timerInterval);
          if(!gameCompleted){gameCompleted=true;showModal('failModal');}
        }
      },1000);
    }
    function passGame(){
      if(gameCompleted)return;gameCompleted=true;clearInterval(timerInterval);
      let used=60-timeRemain,stars=3;
      if(used>50||errorCount>=6)stars=1;else if(used>40||errorCount>=3)stars=2;
      updateLevelProgress('game5',5,stars);
      playSound('win');
      document.getElementById('starRating').textContent = 'â­'.repeat(stars)+'â˜†'.repeat(3-stars);
      document.getElementById('timeUsed').textContent=`ç”¨æ—¶: ${used}ç§’`;
      showModal('resultModal');
    }
    window.onload=function(){renderShapes();startTimer();errorCount=0;gameCompleted=false;}
    </script>
</body>
</html>
