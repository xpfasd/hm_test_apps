<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬5å…³ - ååº”ç‚¹å‡»</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .reaction-area{position:relative;width:100%;max-width:380px;height:380px;margin:20px auto;background:linear-gradient(135deg,#a8edea,#fed6e3);border-radius:20px;overflow:hidden;box-shadow:0 4px 15px rgba(0,0,0,.15);}
        .target-animal{position:absolute;font-size:36px;cursor:pointer;transition:all .25s;animation:appear .3s;}
        .target-animal:active{transform:scale(.9);}
        @keyframes appear{from{transform:scale(0);}to{transform:scale(1);}}
        .score-display{text-align:center;font-size:22px;color:#666;margin:15px 0;}
        .score-num{font-size:32px;font-weight:bold;color:#ff6b6b;}
    </style>
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header"><div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info"><div class="level-title">ååº”ç‚¹å‡» â€¢ ç¬¬ 5 å…³ ğŸ‘‘</div><div class="timer" id="timer">â±ï¸ 30ç§’</div></div>
        </div>
        <div class="game-area">
            <div class="game-instruction">ğŸ† <strong>æŒ‘æˆ˜å…³å¡ï¼</strong><br>åªç‚¹å‡»<strong>ğŸ¯</strong>ï¼Œä¸è¦ç‚¹å…¶å®ƒï¼<br><small style="color:#e17055">30ç§’å†…ç‚¹åˆ°20åªï¼é€Ÿåº¦è¶…å¿«ï¼</small></div>
            <div class="score-display">å¾—åˆ†ï¼š<span class="score-num" id="score">0</span> / 20</div>
            <div class="reaction-area" id="reactionArea"></div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content"><h2>ğŸ‰ æ­å–œé€šå…³!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p>ä½ æ˜¯ååº”ä¹‹ç‹ï¼ğŸ†</p>
            <p id="finalScore"></p>
            <div><button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button><button class="btn btn-primary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button></div>
        </div>
    </div>
    <div class="modal" id="failModal">
        <div class="modal-content"><h2>â° æ—¶é—´åˆ°!</h2><p>æŒ‘æˆ˜å…³å¡å¾ˆéš¾ï¼Œä½†ä½ å·²ç»å¾ˆæ£’äº†ï¼</p><div><button class="btn btn-secondary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button><button class="btn btn-primary" onclick="retryLevel()">ğŸ”„ é‡æ–°å¼€å§‹</button></div></div>
    </div>
    <script src="js/main.js"></script>
    <script>
    const TARGET='ğŸ¯',OTHERS=['ğŸ¶','ğŸ±','ğŸ°','ğŸ¦Š','ğŸ»','ğŸ¼','ğŸ¨','ğŸ¦','ğŸ·'],GOAL=20,TIME_LIMIT=30;
    let score=0,timeRemain=TIME_LIMIT,timerInt,spawnInt,gameCompleted=false,errorCount=0;
    function initGame(){
      score=0;timeRemain=TIME_LIMIT;gameCompleted=false;errorCount=0;
      document.getElementById('score').textContent=score;
      document.getElementById('timer').textContent=`â±ï¸ ${timeRemain}ç§’`;
      startTimer();
      startSpawning();
    }
    function startTimer(){
      const timerEl=document.getElementById('timer');
      timerInt=setInterval(()=>{
        timeRemain--;
        timerEl.textContent=`â±ï¸ ${timeRemain}ç§’`;
        if(timeRemain<=10)timerEl.style.color='#e17055';
        if(timeRemain<=0){
          clearInterval(timerInt);clearInterval(spawnInt);
          if(!gameCompleted){gameCompleted=true;showModal('failModal');}
        }
      },1000);
    }
    function startSpawning(){
      spawnInt=setInterval(()=>{
        if(gameCompleted)return;
        spawnAnimal();
      },700);
    }
    function spawnAnimal(){
      const area=document.getElementById('reactionArea');
      const isTarget=Math.random()>0.5;
      const animal=document.createElement('div');
      animal.className='target-animal';
      animal.textContent=isTarget?TARGET:OTHERS[Math.floor(Math.random()*OTHERS.length)];
      const maxX=area.clientWidth-42;
      const maxY=area.clientHeight-42;
      animal.style.left=Math.random()*maxX+'px';
      animal.style.top=Math.random()*maxY+'px';
      animal.onclick=()=>clickAnimal(animal,isTarget);
      area.appendChild(animal);
      setTimeout(()=>{if(animal.parentNode)animal.remove();},1100);
    }
    function clickAnimal(el,isTarget){
      el.remove();
      if(isTarget){
        playSound('correct');
        score++;
        document.getElementById('score').textContent=score;
        if(score>=GOAL){
          clearInterval(timerInt);clearInterval(spawnInt);
          gameCompleted=true;
          setTimeout(()=>passGame(),400);
        }
      }else{
        playSound('wrong');
        errorCount++;
      }
    }
    function passGame(){
      let used=TIME_LIMIT-timeRemain,stars=3;
      if(used>27||errorCount>=10)stars=1;else if(used>23||errorCount>=6)stars=2;
      updateLevelProgress('game10',5,stars);
      playSound('win');
      document.getElementById('starRating').textContent='â­'.repeat(stars)+'â˜†'.repeat(3-stars);
      document.getElementById('finalScore').textContent=`å®Œæˆæ—¶é—´ï¼š${used}ç§’`;
      showModal('resultModal');
    }
    window.onload=initGame;
    </script>
</body>
</html>

