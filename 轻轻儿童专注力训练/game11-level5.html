<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬5å…³ - ç©ºé—´åŒ¹é…</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .spatial-grid{display:grid;grid-template-columns:repeat(4,58px);gap:9px;max-width:270px;margin:25px auto;}
        .spatial-card{width:58px;height:58px;border-radius:14px;background:linear-gradient(135deg,#fab1a0,#ff7675);display:flex;align-items:center;justify-content:center;font-size:36px;cursor:pointer;border:4px solid transparent;transition:all .2s;box-shadow:0 4px 10px rgba(0,0,0,.15);}
        .spatial-card.selected{border-color:#00b894;background:linear-gradient(135deg,#55efc4,#00b894);transform:scale(1.05);}
        .spatial-card.wrong{border-color:#e17055;animation:shake .5s;}
        .reference-box{background:white;border-radius:18px;padding:15px;margin:0 auto 20px;max-width:300px;text-align:center;box-shadow:0 4px 10px rgba(0,0,0,.1);}
    </style>
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header"><div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info"><div class="level-title">ç©ºé—´åŒ¹é… â€¢ ç¬¬ 5 å…³ ğŸ‘‘</div><div class="timer" id="timer">â±ï¸ 0ç§’</div></div>
        </div>
        <div class="game-area">
            <div class="game-instruction">ğŸ† <strong>æŒ‘æˆ˜å…³å¡ï¼</strong><br>æ‰¾å‡ºå’Œå‚è€ƒå›¾<strong>å½¢çŠ¶+é¢œè‰²+å¤§å°</strong>éƒ½ç›¸åŒçš„ï¼</div>
            <div class="reference-box">
                <div style="font-size:16px;color:#666;margin-bottom:8px;">å‚è€ƒå›¾(ç»¼åˆåŒ¹é…)</div>
                <div style="font-size:55px;" id="referenceShape">ğŸ”º</div>
            </div>
            <div class="spatial-grid" id="spatialGrid"></div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content"><h2>ğŸ‰ æ­å–œé€šå…³!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p>ä½ æ˜¯ç©ºé—´åŒ¹é…å¤§å¸ˆï¼ğŸ†</p>
            <p id="timeUsed">ç”¨æ—¶: 0ç§’</p>
            <div><button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button><button class="btn btn-primary" onclick="goHome()">ğŸ  è¿”å›ä¸»é¡µ</button></div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
    const ALL_SHAPES=[
      {emoji:'ğŸ”º',shape:'triangle',color:'red',size:'large'},
      {emoji:'ğŸ”»',shape:'triangle',color:'red',size:'small'},
      {emoji:'ğŸ”µ',shape:'circle',color:'blue',size:'large'},
      {emoji:'ğŸ”´',shape:'circle',color:'red',size:'small'},
      {emoji:'ğŸŸ¦',shape:'square',color:'blue',size:'large'},
      {emoji:'ğŸŸ¥',shape:'square',color:'red',size:'large'},
      {emoji:'ğŸŸ¡',shape:'circle',color:'yellow',size:'small'},
      {emoji:'ğŸŸ¨',shape:'square',color:'yellow',size:'large'},
      {emoji:'ğŸŸ©',shape:'square',color:'green',size:'large'},
      {emoji:'ğŸŸ¢',shape:'circle',color:'green',size:'small'},
      {emoji:'ğŸ”¶',shape:'diamond',color:'orange',size:'large'},
      {emoji:'ğŸ”¸',shape:'diamond',color:'pink',size:'small'}
    ];
    let targetShape,timerInterval,startTime,errorCount=0;
    function initGame(){
      startTime=Date.now();errorCount=0;
      targetShape=ALL_SHAPES[Math.floor(Math.random()*ALL_SHAPES.length)];
      document.getElementById('referenceShape').textContent=targetShape.emoji;
      document.getElementById('referenceShape').style.fontSize=targetShape.size==='small'?'40px':'55px';
      renderCards();
      startTimer();
    }
    function renderCards(){
      const grid=document.getElementById('spatialGrid');
      grid.innerHTML='';
      const shuffled=[...ALL_SHAPES].sort(()=>Math.random()-.5);
      shuffled.forEach((item,idx)=>{
        const card=document.createElement('div');
        card.className='spatial-card';
        card.textContent=item.emoji;
        card.style.fontSize=item.size==='small'?'28px':'36px';
        card.dataset.id=JSON.stringify({shape:item.shape,color:item.color,size:item.size});
        card.onclick=()=>selectCard(card,item);
        grid.appendChild(card);
      });
    }
    function selectCard(card,item){
      if(item.shape===targetShape.shape&&item.color===targetShape.color&&item.size===targetShape.size){
        playSound('correct');
        card.classList.add('selected');
        setTimeout(()=>passGame(),400);
      }else{
        playSound('wrong');
        card.classList.add('wrong');
        errorCount++;
        setTimeout(()=>card.classList.remove('wrong'),650);
      }
    }
    function startTimer(){timerInterval=setInterval(()=>{let t=Math.floor((Date.now()-startTime)/1000);document.getElementById('timer').textContent=`â±ï¸ ${t}ç§’`;},1000);}
    function passGame(){clearInterval(timerInterval);let used=Math.floor((Date.now()-startTime)/1000),stars=3;if(used>45||errorCount>=6)stars=1;else if(used>32||errorCount>=4)stars=2;updateLevelProgress('game11',5,stars);playSound('win');document.getElementById('starRating').textContent='â­'.repeat(stars)+'â˜†'.repeat(3-stars);document.getElementById('timeUsed').textContent=`ç”¨æ—¶: ${used}ç§’`;showModal('resultModal');}
    window.onload=initGame;
    </script>
</body>
</html>

