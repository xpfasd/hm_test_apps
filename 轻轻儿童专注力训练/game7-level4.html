<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬4å…³ - æ’åºå°åŠ¨ç‰©</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .sort-container {max-width:380px;margin:20px auto;}
        .sort-instruction {text-align:center;font-size:20px;color:#666;margin-bottom:20px;}
        .animals-list {display:flex;flex-direction:column;gap:10px;}
        .animal-item {background:linear-gradient(135deg,#ffe57f,#ff6b6b);border-radius:18px;padding:15px 20px;display:flex;align-items:center;gap:15px;cursor:move;border:3px solid transparent;transition:all .2s;user-select:none;}
        .animal-item.dragging {opacity:.5;border-color:#00b894;}
        .animal-item .emoji {font-size:38px;}
        .animal-item .speed-label {font-size:17px;color:#666;font-weight:bold;}
        .check-btn {margin:20px auto 0;display:block;}
    </style>
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header"><div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info"><div class="level-title">æ’åºå°åŠ¨ç‰© â€¢ ç¬¬ 4 å…³</div><div class="timer" id="timer">â±ï¸ 0ç§’</div></div>
        </div>
        <div class="game-area">
            <div class="game-instruction">æ ¹æ®<strong>é€Ÿåº¦</strong>æ‹–åŠ¨æ’åºï¼Œä»æœ€æ…¢åˆ°æœ€å¿«ï¼</div>
            <div class="sort-container">
                <div class="sort-instruction">ï¼ˆä¹Œé¾Ÿæœ€æ…¢ï¼Œå…”å­è¾ƒå¿«...ï¼‰</div>
                <div class="animals-list" id="animalsList"></div>
                <button class="btn btn-primary check-btn" onclick="checkOrder()">âœ“ æ£€æŸ¥ç­”æ¡ˆ</button>
            </div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2>ğŸ‰ å¤ªæ£’äº†!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p>é€Ÿåº¦æ’åºæ­£ç¡®ï¼</p>
            <p id="timeUsed">ç”¨æ—¶: 0ç§’</p>
            <p id="resultTips" style="margin-top:15px;padding:10px;background:#fff3cd;border-radius:8px;font-size:14px;line-height:1.6;color:#856404;"></p>
            <div>
                <button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-primary" onclick="nextLevel('game7',4)">â¡ï¸ ä¸‹ä¸€å…³</button>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
    // ä½->é«˜ï¼šğŸ¢ä¹Œé¾Ÿ(1)< ğŸ­è€é¼ (2)< ğŸ±çŒ«(3)< ğŸ°å…”å­(4)< ğŸ¦Šç‹ç‹¸(5)< ğŸ¦ç‹®å­(6)
    const ANIMALS=[
      {emoji:'ğŸ¢',speed:1,label:'ä¹Œé¾Ÿ'},
      {emoji:'ğŸ­',speed:2,label:'è€é¼ '},
      {emoji:'ğŸ±',speed:3,label:'çŒ«'},
      {emoji:'ğŸ°',speed:4,label:'å…”å­'},
      {emoji:'ğŸ¦Š',speed:5,label:'ç‹ç‹¸'},
      {emoji:'ğŸ¦',speed:6,label:'ç‹®å­'}
    ];
    let currentOrder=[],correctOrder=[],timerInterval,startTime,errorCount=0;
    function initGame(){
      startTime=Date.now();errorCount=0;
      correctOrder=ANIMALS.map(a=>a.speed).sort((a,b)=>a-b);
      currentOrder=ANIMALS.map((a,i)=>i).sort(()=>Math.random()-.5);
      renderAnimals();
      startTimer();
    }
    function renderAnimals(){
      let list=document.getElementById('animalsList');
      list.innerHTML='';
      currentOrder.forEach((idx,pos)=>{
        let animal=ANIMALS[idx];
        let div=document.createElement('div');
        div.className='animal-item';
        div.draggable=true;
        div.dataset.idx=idx;
        div.innerHTML=`<div class="emoji">${animal.emoji}</div><div class="speed-label">${animal.label}</div>`;
        div.addEventListener('dragstart',handleDragStart);
        div.addEventListener('dragover',handleDragOver);
        div.addEventListener('drop',handleDrop);
        div.addEventListener('dragend',handleDragEnd);
        list.appendChild(div);
      });
    }
    let dragSrcEl=null;
    function handleDragStart(e){dragSrcEl=this;this.classList.add('dragging');e.dataTransfer.effectAllowed='move';e.dataTransfer.setData('text/html',this.innerHTML);}
    function handleDragOver(e){if(e.preventDefault){e.preventDefault();}e.dataTransfer.dropEffect='move';return false;}
    function handleDrop(e){if(e.stopPropagation){e.stopPropagation();}if(dragSrcEl!==this){let srcIdx=parseInt(dragSrcEl.dataset.idx);let tgtIdx=parseInt(this.dataset.idx);let srcPos=currentOrder.indexOf(srcIdx);let tgtPos=currentOrder.indexOf(tgtIdx);[currentOrder[srcPos],currentOrder[tgtPos]]=[currentOrder[tgtPos],currentOrder[srcPos]];renderAnimals();playSound('click');}return false;}
    function handleDragEnd(e){this.classList.remove('dragging');}
    function checkOrder(){let userOrder=currentOrder.map(idx=>ANIMALS[idx].speed);if(JSON.stringify(userOrder)===JSON.stringify(correctOrder)){playSound('correct');setTimeout(()=>passGame(),300);}else{playSound('wrong');errorCount++;alert('æ’åºä¸å¯¹å“¦ï¼Œå†è¯•è¯•ï¼');}}
    function startTimer(){timerInterval=setInterval(()=>{let t=Math.floor((Date.now()-startTime)/1000);document.getElementById('timer').textContent=`â±ï¸ ${t}ç§’`;},1000);}
    function passGame(){clearInterval(timerInterval);let used=Math.floor((Date.now()-startTime)/1000),stars=3;if(used>60||errorCount>=5)stars=1;else if(used>35||errorCount>=2)stars=2;updateLevelProgress('game7',4,stars);playSound('win');document.getElementById('starRating').textContent='â­'.repeat(stars)+'â˜†'.repeat(3-stars);document.getElementById('timeUsed').textContent=`ç”¨æ—¶: ${used}ç§’`;showModal('resultModal');}
    window.onload=initGame;
    </script>
</body>
</html>
