<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬2å…³ - æ•°æ•°é¡¹ç›®</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="game-page">
    <div class="container">
        <div class="game-header">
            <div class="back-btn" onclick="goHome()">â¬…ï¸</div>
            <div class="game-info">
                <div class="level-title">æ•°æ•°é¡¹ç›® â€¢ ç¬¬ 2 å…³</div>
                <div class="timer" id="timer">â±ï¸ 0ç§’</div>
            </div>
        </div>
        <div class="game-area">
            <div class="game-instruction">æ•°ä¸€æ•°æœ‰å‡ åª<br><strong id="targetAnimal">ğŸ¶</strong>ï¼Ÿ</div>
            <div class="animals-grid" id="animalsGrid" style="grid-template-columns: repeat(3, 1fr);"></div>
            <div style="margin-top: 30px;">
                <div style="font-size: 18px; color: #666; margin-bottom: 15px;">é€‰æ‹©ç­”æ¡ˆï¼š</div>
                <div id="answersGrid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 280px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2>ğŸ‰ å¤ªæ£’äº†!</h2>
            <div class="star-rating" id="starRating">â­â­â­</div>
            <p>æ•°æ•°è¶Šæ¥è¶Šå‰å®³äº†ï¼</p>
            <p id="timeUsed">ç”¨æ—¶: 0ç§’</p>
            <p id="resultTips" style="margin-top:15px;padding:10px;background:#fff3cd;border-radius:8px;font-size:14px;line-height:1.6;color:#856404;"></p>
            <div>
                <button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-primary" onclick="nextLevel('game4', 2)">â¡ï¸ ä¸‹ä¸€å…³</button>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
        const ANIMALS = ['ğŸ¶', 'ğŸ±', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼'];
        const GAME_CONFIG = { level: 2, game: 'game4', maxCount: 5 };
        let startTime, timerInterval, correctAnswer;

        function initGame() {
            startTime = Date.now();
            const targetAnimal = ANIMALS[Math.floor(Math.random() * ANIMALS.length)];
            correctAnswer = Math.floor(Math.random() * GAME_CONFIG.maxCount) + 1;
            
            document.getElementById('targetAnimal').textContent = targetAnimal;
            
            const animals = [];
            for (let i = 0; i < correctAnswer; i++) animals.push(targetAnimal);
            const otherCount = 9 - correctAnswer;
            for (let i = 0; i < otherCount; i++) {
                const other = ANIMALS.filter(a => a !== targetAnimal);
                animals.push(other[Math.floor(Math.random() * other.length)]);
            }
            animals.sort(() => Math.random() - 0.5);
            
            const grid = document.getElementById('animalsGrid');
            grid.innerHTML = '';
            animals.forEach(animal => {
                const card = document.createElement('div');
                card.className = 'animal-card';
                card.textContent = animal;
                card.style.cursor = 'default';
                card.onclick = null;
                grid.appendChild(card);
            });
            
            const answersGrid = document.getElementById('answersGrid');
            answersGrid.innerHTML = '';
            for (let i = 1; i <= 6; i++) {
                const btn = document.createElement('div');
                btn.className = 'animal-card';
                btn.style.background = 'linear-gradient(135deg, #a29bfe, #6c5ce7)';
                btn.style.fontSize = '32px';
                btn.style.cursor = 'pointer';
                btn.textContent = i;
                btn.onclick = () => checkAnswer(i, btn);
                answersGrid.appendChild(btn);
            }
            
            startTimer();
        }

        function checkAnswer(answer, btn) {
            if (answer === correctAnswer) {
                playSound('correct');
                btn.classList.add('correct');
                setTimeout(() => completeGame(), 500);
            } else {
                playSound('wrong');
                btn.classList.add('wrong');
                setTimeout(() => btn.classList.remove('wrong'), 1000);
            }
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                document.getElementById('timer').textContent = `â±ï¸ ${elapsed}ç§’`;
            }, 1000);
        }

        function completeGame() {
            clearInterval(timerInterval);
            const timeUsed = Math.floor((Date.now() - startTime) / 1000);
            let stars = timeUsed <= 15 ? 3 : timeUsed <= 30 ? 2 : 1;
            updateLevelProgress(GAME_CONFIG.game, GAME_CONFIG.level, stars);
            playSound('win');
            document.getElementById('starRating').textContent = 'â­'.repeat(stars) + 'â˜†'.repeat(3 - stars);
            document.getElementById('timeUsed').textContent = `ç”¨æ—¶: ${timeUsed}ç§’`;
            setTimeout(() => showModal('resultModal'), 800);
        }

        window.onload = initGame;
    </script>
</body>
</html>

