<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¬¬1å…³ - è®°å¿†å›¾æ¡ˆ</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body {background: #fffbe6;}
        .memory-area {max-width:340px;margin:26px auto;background:#fff;border-radius:18px;box-shadow:0 2px 18px #ffe08244;padding:8px 8px 25px 8px;text-align:center;}
        .view-row,.choose-row {display: flex; justify-content: center;gap:24px; margin:18px 0;}
        .mem-img {width:60px;height:60px;border-radius:18px;background:#ffe6f2;display:flex;align-items:center;justify-content:center;font-size:44px;box-shadow:0 1px 6px #ffd6e6;transition:transform .14s;}
        .choice {width:60px;height:60px;border-radius:14px;background:#f1f8e9;display:flex;align-items:center;justify-content:center;font-size:35px;box-shadow:0 1px 3px #ced99b;cursor:pointer;transition:transform .14s,background .14s;}
        .choice.selected {background:#c8ffd4;transform:scale(1.06);}
        .choice.correct {background:#9ffcf8;animation:bounce .7s;}
        .choice.wrong {background:#fff1f1;animation:shake .4s;}
        .check-btn{margin-top:18px;font-size:18px;padding:6px 18px;border-radius:9px;background:#ffecb3;border:none;color:#a97400;font-weight:bold;cursor:pointer;box-shadow:0 1px 4px #ffda79;transition:background .13s;}
        .check-btn:active{background:#ffd740;}
    </style>
</head>
<body class="game-page">
<div class="container">
    <div class="game-header">
        <div class="back-btn" onclick="goHome()">â¬…ï¸</div>
        <div class="game-info"><div class="level-title">è®°å¿†å›¾æ¡ˆ â€¢ ç¬¬1å…³</div><div class="timer" id="timer">â±ï¸ 0ç§’</div></div>
    </div>
    <div class="game-area">
        <div class="game-instruction">è®°ä½å°åŠ¨ç‰©å›¾æ¡ˆé¡ºåºï¼Œä¸€ç§’åè¯·æŒ‰é¡ºåºè¿˜åŸï¼</div>
        <div class="memory-area">
            <div class="view-row" id="memoryRow"></div>
            <div style="font-size:14px; color:#aaa; margin:7px 0">â†“è¯·ç‚¹åº•ä¸‹æ‹¼å¥½é¡ºåºï¼Œå†ç‚¹â€œæäº¤â€</div>
            <div class="choose-row" id="choiceRow"></div>
            <button class="check-btn" id="checkBtn" onclick="checkResult()">æäº¤</button>
        </div>
    </div>
</div>
<div class="modal" id="resultModal">
    <div class="modal-content"><h2 id="resultTitle"></h2>
        <div class="star-rating" id="starRating">â­â­â­</div>
        <p id="resultMsg"></p>
        <p id="timeUsed"></p>
        <div><button class="btn btn-secondary" onclick="retryLevel()">ğŸ”„ å†ç©ä¸€æ¬¡</button><button class="btn btn-primary" onclick="nextLevel('game9',1)">â¡ï¸ ä¸‹ä¸€å…³</button></div>
    </div>
</div>
<script src="js/main.js"></script>
<script>
const source = [
    {animal: 'ğŸ¦Š', name: 'ç‹ç‹¸'},
    {animal: 'ğŸ¸', name: 'é’è›™'},
    {animal: 'ğŸ¥', name: 'å°é¸¡'},
];
let memory = [],choices=[],userOrder=[],startTime,timerInt;
function shuffle(arr){return arr.sort(()=>Math.random()-.5)}
function renderMemory(){
    const row=document.getElementById('memoryRow');row.innerHTML='';
    memory.forEach(item=>{
        let dom=document.createElement('div');
        dom.className='mem-img';
        dom.textContent=item.animal;
        row.appendChild(dom);
    })
}
function renderChoices(){
    const row=document.getElementById('choiceRow');row.innerHTML='';
    choices.forEach((item,idx)=>{
        let dom=document.createElement('div');
        dom.className='choice'+(userOrder[idx]!=null?" selected":"");
        dom.textContent=item.animal;
        dom.onclick=()=>selectAnimal(idx);
        row.appendChild(dom);
    })
}
function selectAnimal(idx){
    if(userOrder.length>=memory.length)return;
    const cho=choices[idx];
    if(userOrder.includes(idx))return;
    userOrder.push(idx);renderChoices();
}
function checkResult(){
    if(userOrder.length!==memory.length)return shakeBtn();
    let correct=true;
    for(let i=0;i<memory.length;i++){
        if(choices[userOrder[i]].animal!==memory[i].animal)correct=false;
    }
    let used=Math.floor((Date.now()-startTime)/1000),stars=3;
    if(!correct){showFinal(false,used,1);return;}
    if(used>25)stars=1;else if(used>12)stars=2;
    showFinal(true,used,stars);
    updateLevelProgress('game9',1,stars);
}
function shakeBtn(){let btn=document.getElementById('checkBtn');btn.style.animation='shake .4s';setTimeout(()=>btn.style.animation='',420);}
function showFinal(ok,used,stars){
    showModal('resultModal');
    document.getElementById('resultTitle').textContent=ok?'âœ”ï¸ æ­å–œï¼':'ğŸ˜… å†æ¥ä¸€æ¬¡';
    document.getElementById('resultMsg').textContent=ok?'é¡ºåºå…¨å¯¹ï¼Œå°åŠ¨ç‰©å¿«ä¹ï¼':'é¡ºåºé”™å•¦ï¼Œè®°å¿†å†åŠªåŠªåŠ›ï¼';
    document.getElementById('starRating').textContent='â­'.repeat(stars)+'â˜†'.repeat(3-stars);
    document.getElementById('timeUsed').textContent=`ç”¨æ—¶: ${used}ç§’`;
    playSound(ok?'win':'wrong');
}
window.onload=function(){
    memory=shuffle(source.slice());choices=shuffle(source.slice());userOrder=[];
    renderMemory();setTimeout(()=>{
        document.getElementById('memoryRow').style.visibility='hidden';
        renderChoices();startTime=Date.now();
    },2200);
    document.getElementById('memoryRow').style.visibility='visible';
    document.getElementById('checkBtn').disabled=false;
    document.getElementById('timer').textContent='â±ï¸ 0ç§’';
    if(timerInt)clearInterval(timerInt);
    timerInt=setInterval(()=>{
        let t=Math.floor((Date.now()-startTime)/1000)||0;
        document.getElementById('timer').textContent=`â±ï¸ ${t}ç§’`;
    },1000);
}
</script>
</body>
</html>

